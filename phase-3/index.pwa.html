<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <base href="./">
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0b5fff" />
  <title>Algebra Tutor (PWA)</title>
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  <style>
    :root { --bg:#fff; --fg:#111; --muted:#606770; --brand:#0b5fff; }
    * { box-sizing:border-box }
    body { margin:0; font: 16px system-ui, -apple-system, Segoe UI, Roboto, Helvetica; color:var(--fg); background:var(--bg); }
    header { padding:12px 16px; background:var(--brand); color:#fff; position:sticky; top:0; z-index:10 }
    h1 { margin:0; font-size:20px; }
    main { padding:16px; max-width:960px; margin:0 auto; }
    .row { display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
    button, select, input[type=text], input[type=number] { padding:10px 12px; border:1px solid #ccc; border-radius:10px; background:#fff; }
    button { cursor:pointer; border-color:#bbb; }
    button.primary { background:var(--brand); color:#fff; border:none; }
    .card { border:1px solid #ddd; border-radius:12px; padding:12px; margin:12px 0; box-shadow:0 1px 3px rgba(0,0,0,.06); }
    .muted { color:var(--muted); }
    .grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap:12px; }
    .right { text-align:right }
    .mb8 { margin-bottom:8px }
    .mt8 { margin-top:8px }
  </style>
</head>
<body>
  <header><h1>Algebra Tutor (PWA)</h1></header>
  <main>
    <section class="card">
      <div class="row">
        <span class="pill">Student</span>
        <select id="studentSelect"></select>
        <button id="addStudentBtn">Add Student</button>
        <button id="delStudentBtn">Delete</button>
        <span class="muted" id="storageInfo"></span>
      </div>
    </section>

    <section class="grid">
      <div class="card">
        <h3>Placement Quiz</h3>
        <p class="muted">8 quick questions to suggest a starting module.</p>
        <button class="primary" id="startPlacement">Start Quiz</button>
        <div id="placementResult" class="mt8"></div>
      </div>

      <div class="card">
        <h3>Lessons</h3>
        <div class="row mb8">
          <select id="moduleSelect"></select>
          <select id="lessonSelect"></select>
          <button id="startLesson" class="primary">Start Lesson</button>
        </div>
        <div id="lessonIntro" class="muted"></div>
      </div>

      <div class="card">
        <h3>Quick Practice</h3>
        <div class="row">
          <select id="practiceSelect"></select>
          <input type="number" id="practiceCount" min="1" max="50" value="5" />
          <button id="startPractice" class="primary">Start</button>
        </div>
      </div>

      <div class="card">
        <h3>Teacher Mode</h3>
        <div class="row mb8">
          <select id="worksheetTopic"></select>
          <input type="number" id="worksheetCount" min="1" max="50" value="10" />
        </div>
        <div class="row">
          <button id="downloadTxt">Download TXT</button>
          <button id="downloadPdf" class="primary">Download PDF</button>
        </div>
        <p id="pdfHint" class="muted mt8">PDF export uses jsPDF; works offline once cached.</p>
      </div>

      <div class="card">
        <h3>Graphs</h3>
        <canvas id="progressChart" height="220"></canvas>
        <div class="right mt8"><button id="refreshChart">Refresh</button></div>
      </div>
    </section>

    <section class="card">
      <h3 id="activityTitle" class="mb8">Activity</h3>
      <div id="activity"></div>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js" defer></script>
  <script src="app.js?v=1" defer></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./service-worker.js', { scope: './' }).catch(console.error);
    }
  </script>
</body>
</html>
